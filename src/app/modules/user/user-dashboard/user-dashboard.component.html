<header class="text-white text-center py-3 bg-primary">
  <h2 class="fw-bold mb-0">
    <i class="bi bi-speedometer2 me-2"></i> User Dashboard
  </h2>
  <p class="text-light fw-bold fst-italic mb-0 ">"Explore, borrow, and enjoy!"</p>
</header>

<div class="d-flex" style="height: calc(100vh - 82px);">
  <!-- Sidebar -->
  <aside
  class="p-4 text-dark bg-light border-end h-100"
  style="width: 320px; flex-shrink: 0;">
      <div class="d-flex align-items-center flex-column">
        <div class="mb-2">
          <h5 class="fw-bold">
            ðŸ‘‹ Welcome, <span class="text-success">{{ user?.username }}</span>
          </h5>
        </div>

        <div class="mb-3">
          <img 
            src="assets/images/user.webp" 
            alt="Profile Picture" 
            class="rounded-circle mx-auto d-block" 
            width="75" height="75"
          />
        </div>
      </div>


<div class="d-flex flex-column gap-2 flex-grow-1">
      <button class="btn btn-outline-primary text-start fw-semibold w-100 d-flex align-items-center"
          [routerLink]="['/user']" routerLinkActive="active" [routerLinkActiveOptions]="{ exact: true }">
          <i class="bi bi-speedometer me-2"></i>Dashboard
      </button>

      <button class="btn btn-outline-primary text-start fw-semibold w-100 d-flex align-items-center"
          [routerLink]="['/user/recommendations']"
          routerLinkActive="active">
          <i class="bi bi-person-circle me-2"></i>AI Recommended Books
      </button>

      <button class="btn btn-outline-primary text-start fw-semibold w-100 d-flex align-items-center"
          [routerLink]="['/user/browse-books']"
          routerLinkActive="active">
          <i class="bi bi-book me-2"></i>Browse Books
      </button>

      <button class="btn btn-outline-primary text-start fw-semibold w-100 d-flex align-items-center"
          [routerLink]="['/user/borrow-history']"
          routerLinkActive="active">
          <i class="bi bi-journal-text me-2"></i>Borrow History
      </button>
      <button class="btn btn-outline-primary text-start fw-semibold w-100 d-flex align-items-center"
          [routerLink]="['/user/user-profile']"
          routerLinkActive="active">
          <i class="bi bi-person-circle me-2"></i>User Profile
      </button>
      <button class="btn btn-outline-light bg-danger text-start fw-semibold w-100 d-flex align-items-center mt-auto"
            (click)="logout()">
            <i class="bi bi-box-arrow-right me-2"></i> Logout
      </button>
    </div>
  </aside>
  <!-- Main Content -->
  <main class="flex-grow-1 p-4 " style="background-color: #f8f9fa;">
    <div *ngIf="showLogoutAlert" 
     class="alert alert-success alert-dismissible fade show mb-3 px-3 py-2 text-center" 
     role="alert" 
     style="max-width: 400px; margin: 1rem auto;">
        Logged out successfully!
     <button type="button" class="btn-close" aria-label="Close" (click)="showLogoutAlert = false"></button>
    </div>
    
    <div *ngIf="isMainDashboard()" class="row g-4">
      <div class="col-md-3">
        <div class="card border-0 shadow-sm h-100" style="border-left: 4px solid #3a7bd5;">
          <div class="card-body text-center">
            <div class="icon-circle mb-3 mx-auto" style="background-color: rgba(58, 123, 213, 0.1);">
              <i class="bi bi-book-half text-primary fs-4"></i>
            </div>
            <h6 class="card-title text-dark">Books Borrowed</h6>
            <p class="fs-3 fw-bold text-dark">{{ borrowedBooks }}</p>
          </div>
        </div>
      </div>
    
      <div class="col-md-3">
        <div class="card border-0 shadow-sm h-100" style="border-left: 4px solid #f39c12;">
          <div class="card-body text-center">
            <div class="icon-circle mb-3 mx-auto" style="background-color: rgba(243, 156, 18, 0.1);">
              <i class="bi bi-hourglass-split text-warning fs-4"></i>
            </div>
            <h6 class="card-title text-dark">Due Soon</h6>
            <p class="fs-3 fw-bold text-dark">{{ dueSoon }}</p>
          </div>
        </div>
      </div>
    
      <div class="col-md-3">
        <div class="card border-0 shadow-sm h-100" style="border-left: 4px solid #28a745;">
          <div class="card-body text-center">
            <div class="icon-circle mb-3 mx-auto" style="background-color: rgba(40, 167, 69, 0.1);">
              <i class="bi bi-arrow-repeat text-success fs-4"></i>
            </div>
            <h6 class="card-title text-dark">Books Returned</h6>
            <p class="fs-3 fw-bold text-dark">{{ returnedBooks }}</p>
          </div>
        </div>
      </div>
    
      <div class="col-md-3">
        <div class="card border-0 shadow-sm h-100" style="border-left: 4px solid #e74c3c;">
          <div class="card-body text-center">
            <div class="icon-circle mb-3 mx-auto" style="background-color: rgba(231, 76, 60, 0.1);">
              <i class="bi bi-exclamation-triangle-fill text-danger fs-4"></i>
            </div>
            <h6 class="card-title text-dark">Overdue</h6>
            <p class="fs-3 fw-bold text-dark">{{ overdueBooks }}</p>
          </div>
        </div>
      </div>
      <div class="card mt-4 shadow-sm">
      <div class="card-header bg-white border-0 fw-bold">
        ðŸ“Š Borrowing Overview
      </div>
      <div class="card-body">
        <highcharts-chart 
          *ngIf="chartOptions && chartOptions.series"
          [Highcharts]="Highcharts"
          [options]="chartOptions"
          style="width: 100%; height: 300px; display: block;">
        </highcharts-chart>
      </div>
    </div>
    </div>
    <app-chat></app-chat>
    <router-outlet></router-outlet>
  </main>
